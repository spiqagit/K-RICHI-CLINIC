name: Test SFTP Connection

on:
  workflow_dispatch:  # 手動実行のみ

jobs:
  test-sftp:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Test SFTP Connection
        uses: appleboy/scp-action@v0.1.7
        with:
          host: ${{ secrets.SFTP_HOST }}
          username: ${{ secrets.SFTP_USERNAME }}
          password: ${{ secrets.SFTP_PASSWORD }}
          port: ${{ secrets.SFTP_PORT || 10022 }}
          source: "README.md"
          target: ${{ secrets.REMOTE_PATH }}/test_connection.txt
          strip_components: 0
          rm: false
          overwrite: true
          debug: true

      - name: Connection Test Result
        run: |
          echo "✅ SFTP connection test successful!"
          echo "The test file has been uploaded to: ${{ secrets.REMOTE_PATH }}/test_connection.txt"
          echo "You can delete this file after confirming the connection works."


