@use 'sass:math';
@use 'sass:string';
@use 'sass:meta';
@function vw($px, $reference) {
  @if $reference == 'pc' {
    @return math.div($px, 1280) * 100vw;
  } @else if $reference == 'tb' {
    @return math.div($px, 1024) * 100vw;
  } @else if $reference == 'sp' {
    @return math.div($px, 428) * 100vw;
  } @else if $reference == 'sp_m' {
    @return math.div($px, 375) * 100vw;
  } @else if $reference == 'sp_s' {
    @return math.div($px, 320) * 100vw;
  } @else {
    @return math.div($px, $reference) * 100vw;
  }
}

@function vwmin($pxValue, $reference, $base: null, $min: 0px, $max: null) {
  // 負の値の場合は$minと$maxを自動調整
  $isNegative: $pxValue < 0;
  
  @if $reference == 'pc' {
    @if not $base {
      $base: 1440;
    }
    @if not $max {
      @if $isNegative {
        $max: $pxValue; // 負の値の場合、最大値は元の値（0に近い値）
        $min: $pxValue * 1.5; // 負の値の場合、最小値はより負の値
      } @else {
        $max: $pxValue * 1.5; // PC: 最大値は元の値の150%（タブレット時も大きめに）
      }
    }
  } @else if $reference == 'tb' {
    @if not $base {
      $base: 768; // タブレットの最小幅を基準に（より大きいサイズになる）
    }
    @if not $max {
      @if $isNegative {
        $max: $pxValue;
        $min: $pxValue * 1.2;
      } @else {
        $max: $pxValue * 1.2; // TB: 最大値は元の値の500%
      }
    }
  } @else if $reference == 'sp' {
    @if not $base {
      $base: 767;
    }
    @if not $max {
      @if $isNegative {
        $max: $pxValue;
        $min: $pxValue * 1.1;
      } @else {
        $max: $pxValue * 1.1; // SP: 最大値は元の値の110%
      }
    }
  } @else if $reference == 'sp_m' {
    @if not $base {
      $base: 428;
    }
    @if not $max {
      @if $isNegative {
        $max: $pxValue;
        $min: $pxValue * 1.1;
      } @else {
        $max: $pxValue * 1.1;
      }
    }
  } @else if $reference == 'sp_s' {
    @if not $base {
      $base: 375;
    }
    @if not $max {
      @if $isNegative {
        $max: $pxValue;
        $min: $pxValue * 1.1;
      } @else {
        $max: $pxValue * 1.1;
      }
    }
  }

  // 負の値で$minが指定されていない場合、自動的に負の値に設定
  @if $isNegative and $min == 0px {
    $min: $pxValue * 1.1;
  }

  $vwValue: math.div($pxValue, $base) * 100vw;

  @return string.unquote('clamp(#{$min}, #{$vwValue}, #{$max}px)');
}

/* -------------------------
px => rem
------------------------- */
@function rem($px) {
  @return $px / 16 * 1rem;
}
